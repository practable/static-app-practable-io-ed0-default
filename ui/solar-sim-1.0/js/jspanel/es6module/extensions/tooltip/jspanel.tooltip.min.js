"use strict";import{jsPanel}from"../../jspanel.js";jsPanel.tooltip||(jsPanel.tooltip={version:"1.0.0",date:"2018-03-13 09:40",defaults:{border:"1px solid",dragit:!1,resizeit:!1,headerControls:"none",delay:400,ttipEvent:"mouseover"},create(t={},e){t.paneltype="tooltip",t.id?"function"==typeof t.id&&(t.id=t.id()):t.id=`jsPanel-${jsPanel.idCounter+=1}`;let o,n=t.target,l=t.mode||"default";if(!n)return!1;"string"==typeof n&&(n=document.querySelector(n)),n.addEventListener(jsPanel.evtStart,t=>{t.stopPropagation()},!1);let s=t;t.config&&delete(s=Object.assign({},t.config,t)).config,(s=Object.assign({},this.defaults,s)).position=Object.assign({},t.position),s.position.of=t.position.of||n,n.addEventListener(s.ttipEvent,()=>{o=window.setTimeout(function(){if(document.getElementById(t.id))return!1;jsPanel.create(s,t=>{if("default"===l?n.addEventListener("mouseleave",()=>{t.close()},!1):"semisticky"===l&&t.addEventListener("mouseleave",()=>{t.close()},!1),t.classList.add("jsPanel-tooltip"),t.style.overflow="visible",t.header.style.cursor="default",t.footer.style.cursor="default",n.closest(".jsPanel-modal")?t.style.zIndex=n.closest(".jsPanel-modal").style.zIndex:(n.closest(".jsPanel")&&n.closest(".jsPanel").front(),t.style.zIndex=jsPanel.zi.next()),t.addEventListener(jsPanel.evtStart,function(t){t.stopPropagation()},!1),s.connector){let e="string"==typeof s.position.of?document.querySelector(s.position.of):s.position.of,o=jsPanel.tooltip.relativeTipPos(t,e);t.append(jsPanel.tooltip.addConnector(t,o))}e&&e.call(t,t)})},s.delay)},!1),n.addEventListener("mouseout",()=>{window.clearTimeout(o)},!1)},relativeTipPos(t,e){let o,n=t.getBoundingClientRect(),l=e.getBoundingClientRect(),s=Math.round(l.left-n.right),i=Math.round(l.top-n.bottom),r=Math.round(n.left-l.right),a=Math.round(n.top-l.bottom);return o=i>=0?s>=0?"left-top":r>=0?"right-top":"top":a>=0?s>=0?"left-bottom":r>=0?"right-bottom":"bottom":s>=0?"left":r>=0?"right":"over"},addConnector(t,e){let o,n,l=document.createElement("div");return l.className=`jsPanel-connector jsPanel-connector-${e}`,"top"===e?t.style.top=parseFloat(t.style.top)-12+"px":"right"===e?t.style.left=parseFloat(t.style.left)+12+"px":"bottom"===e?t.style.top=parseFloat(t.style.top)+12+"px":"left"===e&&(t.style.left=parseFloat(t.style.left)-12+"px"),n="string"==typeof t.options.connector?t.options.connector:window.getComputedStyle(t).borderBottomColor,o=e.match(/-/)?{left:void 0,top:void 0,backgroundColor:n}:{left:void 0,top:void 0,[`border-${e}-color`]:n},jsPanel.setStyle(l,o),l},removeConnector(t){const e=t.querySelector(".jsPanel-connector");t.removeChild(e)}},document.addEventListener(jsPanel.pointerdown,function(t){document.querySelectorAll(".jsPanel-tooltip").forEach(function(e){t.target.closest(".jsPanel-tooltip")||e.close()})},!1));